const EventResponse = require('../EventResponse');

class RepositoryVulnerabilityAlertCreate extends EventResponse {
  constructor(...args) {
    super(...args, {
      description: 'This event is fired when a vulnerability alert is created',
    });
  }

  embed({ alert, repository }) {
    return {
      color: '#8e44ad',
      title: 'New package vulnerability found',
      url: `${repository.html_url}/network/alerts`,
      description: [
        `Vulnerability found for \`${alert.affected_package_name}\` affecting \`${alert.affected_range}\`.`,
        '',
        `Classified as [${alert.external_identifier}](${alert.external_reference})`,
      ].join('\n'),
    };
  }

  text({ alert }) {
    return [
      `ðŸ›¡ New vulnerability found for **${alert.affected_package_name}** affecting **${alert.affected_range}**. <${alert.external_reference}>`,
    ];
  }
}

module.exports = RepositoryVulnerabilityAlertCreate;
